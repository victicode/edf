import{b6 as _,r as h,bb as y,b as N,e as k,G as L,b3 as K,o as S,H as D,i as C,bc as Y,B as P,b7 as H,bd as Q,av as A,be as O,bf as T,f as Z,k as E,l as X,ab as R,n as j,a9 as ee,bg as oe}from"./index-BSBF4jGH.js";function q(t,n,l){if(n){const o=n.clientWidth,e=n.clientHeight,r=t.left/o,c=t.top/e,v=o*l,s=e*l;let m=-(v-o)*r,d=-(s-e)*c;return m=Math.max(Math.min(m,0),o-v),d=Math.max(Math.min(d,0),e-s),{left:m,top:d}}else return console.error("element not found"),{left:0,top:0}}function te(t,n,l,o,e){if(o){const r=o.clientWidth,c=o.clientHeight,v=c-c*e,s=r-r*e,m=n.left-t.left,d=n.top-t.top;return{left:Math.max(Math.min(l.left+m,0),s),top:Math.max(Math.min(l.top+d,0),v)}}else return console.error("element not found"),{left:0,top:0}}const le=(t,n)=>({left:-t.left*n,top:-t.top*n}),ne=(t,n)=>({left:-t.left/n,top:-t.top/n});function ae(t){const{clientX:n,clientY:l}=t.changedTouches[0];return{left:n,top:l}}function ue(t,n){const{clientX:l,clientY:o}=t.changedTouches[0],e={left:0,top:0};if(n){const r=n.getBoundingClientRect();e.left=l-r.left,e.top=o-r.top}else return console.error("element not found"),e;return e}function x(t,n){if(n){const l=n.getBoundingClientRect(),o=t.clientX-l.left,e=t.clientY-l.top,r=t.clientX<l.left||t.clientX>l.right||t.clientY<l.top||t.clientY>l.bottom;return{pos:{left:o,top:e},isOutside:r}}return{pos:{left:0,top:0},isOutside:!0}}function G(){const t=h(!1);return{isTransition:t,startTransition:(n=150)=>{t.value=!0,setTimeout(()=>{t.value=!1},n)}}}function V(t,n,l,o=2){const e=h("IN");return{zoomDir:e,multiStepZoomIn:(r,c,v)=>{let s=r;e.value==="IN"?s=Math.min(r+v,o):s=Math.max(r-v,1),s===1?e.value="IN":s===o&&(e.value="OUT"),t.value=s,n.value=q(c,l.value,s)}}}const re=["src","alt"],se=_({__name:"DragZoomImg",props:O({src:{},alt:{},zoomScale:{default:2},trigger:{default:"click"},step:{},persist:{type:Boolean}},{currentScale:{default:1},currentScaleModifiers:{},zoomedImgOffset:{default:{left:0,top:0}},zoomedImgOffsetModifiers:{}}),emits:O(["error","load"],["update:currentScale","update:zoomedImgOffset"]),setup(t,{expose:n}){const l=t,o=T(t,"currentScale"),e=T(t,"zoomedImgOffset"),r=h({left:0,top:0}),c=h({left:0,top:0}),v=h(!1),s=N(()=>o.value>1),m=y("container"),d=y("vzImg"),{isTransition:w,startTransition:b}=G(),{multiStepZoomIn:g,zoomDir:z}=V(o,e,m,l.zoomScale),M=i=>{if(l.trigger==="hover"){const{pos:f}=x(i,m.value);b(),g(o.value,f,l.step??l.zoomScale)}},I=()=>{v.value=!1,l.trigger==="hover"&&U()},a=i=>{const f=B(i);r.value=f,c.value=f,s.value&&(v.value=!0)},u=i=>{if(!v.value)return;const f=B(i);e.value=te(r.value,f,e.value,m.value,o.value),r.value=f},p=i=>{v.value=!1;const f=B(i);if(c.value.left===f.left&&c.value.top===f.top){const $=J(s.value?new MouseEvent("mouseup",W()):i);b(),g(o.value,$,l.step??l.zoomScale)}},U=()=>{w.value=!0,o.value=1,e.value={left:0,top:0},z.value="IN"},B=i=>i instanceof MouseEvent?{left:i.clientX,top:i.clientY}:ae(i),J=i=>{if(i instanceof MouseEvent){const{pos:f}=x(i,m.value);return f}else return ue(i,m.value)},W=()=>{var i;const f=(i=m.value)==null?void 0:i.getBoundingClientRect(),$=o.value-1===0?1:o.value-1;return{clientX:-e.value.left/$+((f==null?void 0:f.left)??0),clientY:-e.value.top/$+((f==null?void 0:f.top)??0)}};return n({zoomDir:z,vzImgRef:d,multiZoom:()=>{const i=W();a(new MouseEvent("mousedown",i)),p(new MouseEvent("mouseup",i))}}),(i,f)=>(S(),k("div",{class:j(["vz-zoomimg-img-container overflow-hidden",{"cursor-grab":s.value&&!v.value,"cursor-grabbing":s.value&&v.value,"cursor-zoom-in":!s.value}]),ref:"container",onMouseenter:M,onMousedown:a,onMousemove:u,onMouseup:p,onMouseleave:I,onTouchstart:R(a,["prevent"]),onTouchmove:R(u,["prevent"]),onTouchend:R(p,["prevent"])},[Z("img",{class:"vz-zoomimg-img zoom-effect h-full w-full object-fill",draggable:"false",ref:"vzImg",src:i.src,alt:i.alt,style:E({transform:`translate(${e.value.left}px, ${e.value.top}px) scale(${o.value})`,transformOrigin:"0 0",transition:X(w)?"transform 100ms ease-in-out":"none"}),onError:f[0]||(f[0]=$=>i.$emit("error")),onLoad:f[1]||(f[1]=$=>i.$emit("load"))},null,44,re)],34))}}),ie=["src","alt"],me=_({__name:"MoveZoomImg",props:O({src:{},alt:{},zoomScale:{default:2},trigger:{default:"click"},step:{},persist:{type:Boolean}},{currentScale:{default:1},currentScaleModifiers:{},zoomedImgOffset:{default:{left:0,top:0}},zoomedImgOffsetModifiers:{}}),emits:O(["error","load"],["update:currentScale","update:zoomedImgOffset"]),setup(t,{expose:n}){const l=t,o=T(t,"currentScale"),e=T(t,"zoomedImgOffset"),r=N(()=>o.value>1),c=y("container"),v=y("vzImg"),{isTransition:s,startTransition:m}=G(),{zoomDir:d,multiStepZoomIn:w}=V(o,e,c,l.zoomScale),b=a=>{if(l.trigger==="hover"){const{pos:u}=x(a,c.value);m(),w(o.value,u,l.step??l.zoomScale)}},g=()=>{l.persist||I()},z=a=>{const{pos:u}=x(a,c.value);m(),w(o.value,u,l.step??l.zoomScale)},M=a=>{const{pos:u,isOutside:p}=x(a,c.value);!p&&r.value&&!s.value&&(e.value=q(u,c.value,o.value))},I=()=>{s.value=!0,o.value=1,e.value={left:0,top:0},d.value="IN"};return n({zoomDir:d,vzImgRef:v,multiZoom:()=>{var a;const u=(a=c.value)==null?void 0:a.getBoundingClientRect();u&&z({clientX:u.x+u.width/2,clientY:u.y+u.height/2})}}),(a,u)=>(S(),k("div",{class:"vz-zoomimg-img-container cursor-zoom-in overflow-clip border-none",ref:"container",style:E({cursor:X(d)==="OUT"?"zoom-out":"zoom-in"}),onMouseenter:b,onMouseleave:g,onMousemove:M,onClick:z},[Z("img",{class:"vz-zoomimg-img h-full w-full object-fill",ref:"vzImg",src:a.src,alt:a.alt,style:E({transform:`translate(${e.value.left}px, ${e.value.top}px) scale(${o.value})`,transformOrigin:"0 0",transition:X(s)?"transform 100ms ease-in-out":"none"}),onError:u[0]||(u[0]=p=>a.$emit("error")),onLoad:u[1]||(u[1]=p=>a.$emit("load"))},null,44,ie)],36))}}),ve={class:"vz-zoom-btns-container absolute bottom-1 end-1 z-10 flex gap-2 p-3"},ce=["disabled"],fe=["disabled"],pe=_({__name:"ZoomButtons",props:{maxZoom:{type:Boolean,required:!0},minZoom:{type:Boolean,required:!0}},emits:["zoomIn","zoomOut"],setup(t){return(n,l)=>(S(),k("div",ve,[Z("button",{class:"controls-btn zoom-out-btn",disabled:t.minZoom,onClick:l[0]||(l[0]=o=>n.$emit("zoomOut"))},null,8,ce),Z("button",{class:"controls-btn zoom-in-btn",disabled:t.maxZoom,onClick:l[1]||(l[1]=o=>n.$emit("zoomIn"))},null,8,fe)]))}}),F=(t,n)=>{const l=t.__vccOpts||t;for(const[o,e]of n)l[o]=e;return l},de=F(pe,[["__scopeId","data-v-2c73679c"]]),ge=["alt","src"],ze=_({__name:"ZoomMap",props:O({src:{type:String,required:!0},alt:{type:String,default:"zoomed-img"},zoomScale:{type:Number,default:2}},{position:{type:Object},positionModifiers:{}}),emits:["update:position"],setup(t){const n=T(t,"position"),l=h(!1),o=y("backdrop"),e=y("movableWindow"),r=h(0),c=h(0),v=b=>{if(o.value){const{pos:g}=x(b,o.value);r.value=g.left,c.value=g.top}};L(()=>{o.value&&o.value.addEventListener("mousemove",v)}),ee(()=>{o.value&&o.value.removeEventListener("mousemove",v)}),oe(()=>{l.value&&s()});const s=()=>{n.value=w()},m=()=>{l.value=!0},d=()=>{l.value=!1},w=()=>{var b,g,z,M,I,a;if(o.value&&e.value){const u=((b=o.value)==null?void 0:b.clientHeight)-((g=e.value)==null?void 0:g.clientHeight),p=((z=o.value)==null?void 0:z.clientWidth)-((M=e.value)==null?void 0:M.clientWidth),U=Math.min(Math.max(c.value-Number((I=e.value)==null?void 0:I.clientHeight)/2,0),u),B=Math.min(Math.max(r.value-Number((a=e.value)==null?void 0:a.clientWidth)/2,0),p);return{top:U,left:B}}else console.error("couldn't get movable window new position")};return(b,g)=>{var z,M;return S(),k("div",{class:"vz-map-container relative select-none overflow-clip",ref:"backdrop",onClick:s,onMouseleave:d},[Z("img",{class:"vz-map-img h-full w-full object-fill",ref:"imgRef",alt:t.alt,src:t.src},null,8,ge),Z("div",{class:j(["vz-map-window absolute bg-white/20 hover:cursor-pointer active:cursor-move",{"invisible -z-10":!n.value}]),ref:"movableWindow",style:E({left:`${(z=n.value)==null?void 0:z.left}px`,top:`${(M=n.value)==null?void 0:M.top}px`,width:`${1/t.zoomScale*100}%`,height:`${1/t.zoomScale*100}%`}),onMousedown:m,onMouseup:d},null,38)],544)}}}),he={class:"vz-zoomimg-container relative"},be=_({__name:"ZoomImg",props:{zoomType:{default:"move"},showZoomBtns:{type:Boolean},showImgMap:{type:Boolean},loading:{type:Boolean},src:{},alt:{},zoomScale:{},trigger:{},step:{},persist:{type:Boolean}},emits:["error","load"],setup(t,{emit:n}){const l=n,o=t,e=h(1),r=h({left:0,top:0}),c=h(1080),v=h(!1),s=h(!1),m=y("zoomComponent"),d=N(()=>o.zoomType==="drag"||c.value<768),w=N(()=>{if(e.value!==1)return ne(r.value,e.value*4)}),b=()=>{m.value&&(m.value.zoomDir="IN",m.value.multiZoom())},g=()=>{m.value&&(m.value.zoomDir="OUT",m.value.multiZoom())},z=a=>{a&&(r.value=le(a,e.value*4))},M=()=>{v.value=!0,l("load")},I=()=>{s.value=!0,l("error")};return L(()=>{var a,u;c.value=(window==null?void 0:window.innerWidth)??1080,(u=(a=m.value)==null?void 0:a.vzImgRef)!=null&&u.complete&&(v.value=!0)}),K(()=>{var a,u;v.value=!!((u=(a=m.value)==null?void 0:a.vzImgRef)!=null&&u.complete)}),(a,u)=>(S(),k("div",he,[(S(),D(Q(d.value?se:me),H({"current-scale":e.value,"onUpdate:currentScale":u[0]||(u[0]=p=>e.value=p),"zoomed-img-offset":r.value,"onUpdate:zoomedImgOffset":u[1]||(u[1]=p=>r.value=p)},o,{ref:"zoomComponent",class:["h-full w-full",{hidden:!v.value&&a.$slots.loading||s.value&&a.$slots.error}],alt:a.alt,onError:I,onLoad:M}),null,16,["current-scale","zoomed-img-offset","alt","class"])),v.value?C("",!0):Y(a.$slots,"loading",{key:0},void 0,!0),s.value?Y(a.$slots,"error",{key:1},void 0,!0):C("",!0),a.showZoomBtns?(S(),D(de,H({key:2,"zoomed-img-offset":r.value,"onUpdate:zoomedImgOffset":u[2]||(u[2]=p=>r.value=p),"current-scale":e.value,"onUpdate:currentScale":u[3]||(u[3]=p=>e.value=p)},o,{"max-zoom":e.value===a.zoomScale,"min-zoom":e.value===1,onZoomIn:b,onZoomOut:g}),null,16,["zoomed-img-offset","current-scale","max-zoom","min-zoom"])):C("",!0),a.showImgMap?P((S(),D(ze,{key:3,class:"absolute bottom-[28%] left-0 box-content h-[25%] w-[25%] border-8 border-transparent outline outline-2 outline-offset-[-8px] outline-white",src:a.src,"zoom-scale":e.value,position:w.value,"onUpdate:position":z},null,8,["src","zoom-scale","position"])),[[A,w.value]]):C("",!0)]))}}),we=F(be,[["__scopeId","data-v-95680e56"]]);export{we as b};
