import{Q as M}from"./QSpinnerDots-C4tArpGa.js";import{r as u,O as S,G as B,e as a,f as t,g as p,t as l,i as y,l as V,D,x as k,I as N,q as T,N as I,o as r}from"./index-BSBF4jGH.js";import{u as z}from"./pay.store-76psuZaw.js";import{_ as E}from"./voucherModal-CdJrqyQc.js";import"./vue3-zoomer.es-CLqq-9XB.js";const H={class:"h-full relative overflow-auto"},P={class:"relative z-10 pt-5 pb-2 px-6 h-full"},R={key:0,class:"flex flex-col items-center justify-center py-20"},$={key:1,class:"flex flex-col items-center justify-center py-20"},q={class:"text-gray-600 text-center mb-6"},A={key:2,class:"flex flex-col items-center h-full"},L={class:"bg-white rounded-xl shadow-lg border border-gray-100 w-full max-w-sm md:max-w-4xl p-6 pb-4 mb-8"},Q={class:"space-y-4"},F={class:"flex justify-between items-center pb-2",style:{"border-bottom":"1px solid rgba(211, 211, 211, 0.534)"}},G={class:"text-gray-900 font-semibold"},O={class:"flex justify-between items-center pb-2",style:{"border-bottom":"1px solid rgba(211, 211, 211, 0.534)"}},U={class:"text-gray-900 font-semibold"},J={key:0,class:"flex justify-between items-center pb-2",style:{"border-bottom":"1px solid rgba(211, 211, 211, 0.534)"}},K={class:"text-gray-900 font-semibold"},W={key:1,class:"flex justify-between items-center pb-2",style:{"border-bottom":"1px solid rgba(211, 211, 211, 0.534)"}},X={class:"text-gray-900 font-semibold"},Y={class:"flex justify-between items-center pb-2",style:{"border-bottom":"1px solid rgba(211, 211, 211, 0.534)"}},Z={class:"text-gray-900 font-semibold"},ee={class:"flex justify-between items-center pb-2",style:{"border-bottom":"1px solid rgba(211, 211, 211, 0.534)"}},te={class:"text-gray-900 font-semibold"},se={class:"flex justify-between items-center pb-2",style:{"border-bottom":"1px solid rgba(211, 211, 211, 0.534)"}},oe={class:"text-gray-900 font-semibold"},ae={key:2,class:"flex justify-between items-center pb-2",style:{"border-bottom":"1px solid rgba(211, 211, 211, 0.534)"}},le={class:"text-gray-900 font-semibold"},re=["innerHTML"],ne={class:"flex justify-evenly mt-5"},ie={key:3,class:"flex flex-col items-center justify-center py-20"},fe={__name:"validatePay",setup(de){const b=S(),w=T(),v=z(),f=u(""),s=u(null),m=u(!1),g=u(!0),i=u(null),x=async o=>{try{i.value=null;const e=await v.getPayById(o);s.value=e.data}catch(e){console.error("Error al obtener la reserva:",e),i.value=e||"Error al cargar la reserva"}finally{g.value=!1}},c=b.params.id||b.query.id;B(()=>{c?x(c):i.value="ID de reserva no proporcionado"});const j=()=>{c&&x(c)},_=o=>{m.value=!0;const e={status:o};v.updateStatus({data:e,id:s.value.id}).then(n=>{m.value=!1,h(n.data.messageType,n.data.message),setTimeout(()=>{w.go(-1)},1e3)}).catch(n=>{m.value=!1,h(n.messageType,n.message)})},h=(o,e)=>{I.create({color:o,message:e,timeout:2e3})},C=o=>{f.value=o};return(o,e)=>{var n;return r(),a("div",H,[t("div",P,[g.value?(r(),a("div",R,[p(M,{color:"primary",size:"4rem"}),e[5]||(e[5]=t("p",{class:"text-gray-600 font-medium"},"Cargando reserva...",-1))])):i.value?(r(),a("div",$,[e[6]||(e[6]=t("div",{class:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mb-6"},[t("svg",{class:"w-10 h-10 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),e[7]||(e[7]=t("h2",{class:"text-xl font-bold text-gray-900 mb-2"},"¡Ups! Algo salió mal",-1)),t("p",q,l(i.value),1),t("button",{onClick:j,class:"px-6 py-3 bg-red-500 text-white rounded-full font-medium hover:bg-red-600 transition-colors"}," Reintentar ")])):s.value?(r(),a("div",A,[t("div",L,[t("div",Q,[t("div",F,[e[8]||(e[8]=t("span",{class:"text-gray-600 font-medium"},"Area",-1)),t("span",G,l(s.value.booking.comun_area.name),1)]),t("div",O,[e[9]||(e[9]=t("span",{class:"text-gray-600 font-medium"},"ID de pago",-1)),t("span",U,"#"+l(s.value.pay_id),1)]),s.value.booking?(r(),a("div",J,[e[10]||(e[10]=t("span",{class:"text-gray-600 font-medium"},"Reserva",-1)),t("span",K,"#"+l(((n=s.value.booking)==null?void 0:n.booking_number)||"Área Común"),1)])):y("",!0),s.value.pay_method!=3?(r(),a("div",W,[e[11]||(e[11]=t("span",{class:"text-gray-600 font-medium"},"Refencia de pago",-1)),t("span",X,"#"+l(s.value.reference),1)])):y("",!0),t("div",Y,[e[12]||(e[12]=t("span",{class:"text-gray-600 font-medium"},"Monto pagado",-1)),t("span",Z,"S/. "+l(s.value.amount),1)]),t("div",ee,[e[13]||(e[13]=t("span",{class:"text-gray-600 font-medium"},"Fecha de pago",-1)),t("span",te,l(new Date(s.value.pay_date).toLocaleDateString("es-ES")),1)]),t("div",se,[e[14]||(e[14]=t("span",{class:"text-gray-600 font-medium"},"Método de pago",-1)),t("span",oe,l(s.value.pay_method_label),1)]),s.value.booking?(r(),a("div",ae,[e[15]||(e[15]=t("span",{class:"text-gray-600 font-medium"},"A nombre de",-1)),t("span",le,l(s.value.user.name),1)])):y("",!0)]),s.value.pay_method!=3?(r(),a("div",{key:0,class:"flex flex-center mt-4",onClick:e[0]||(e[0]=d=>C("voucher"))},[e[16]||(e[16]=t("div",{class:"text-center text-subtitle1 text-primary text-bold font-medium cursor-pointer text__vaucher",style:{"text-decoration":"dotted"}}," Vaucher de pago ",-1)),t("span",{class:"ml-2",innerHTML:V(D).voucher},null,8,re)])):y("",!0)]),t("div",null,[t("div",ne,[p(k,{label:"Cancelar",unelevated:"",class:"q-mx-sm",color:"negative",outline:"",style:{"border-radius":"0.8rem",padding:"0px  2rem!important","font-size":"1rem"},onClick:e[1]||(e[1]=d=>_(0))}),p(k,{label:"Aprobar",unelevated:"",class:"q-mx-sm",color:"primary",outline:"",style:{"border-radius":"0.8rem",padding:"0px  2rem!important","font-size":"1rem"},loading:m.value,onClick:e[2]||(e[2]=d=>_(2))},null,8,["loading"])])]),p(E,{vaucher:s.value.vaucher,dialog:f.value=="voucher",onCloseModal:e[3]||(e[3]=d=>f.value="")},null,8,["vaucher","dialog"])])):(r(),a("div",ie,[e[17]||(e[17]=N('<div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-6"><svg class="w-10 h-10 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div><h2 class="text-xl font-bold text-gray-900 mb-2">Pago no encontrado</h2><p class="text-gray-600 text-center mb-6">El pago solicitada no existe o no tienes permisos para verla.</p>',3)),t("button",{onClick:e[4]||(e[4]=(...d)=>o.goToHome&&o.goToHome(...d)),class:"px-6 py-3 bg-gray-500 text-white rounded-full font-medium hover:bg-gray-600 transition-colors"}," Volver al inicio ")]))])])}}};export{fe as default};
