import{c as Y,S as J,U as K,V as W,r as R,b as P,a8 as Z,a9 as ee,h as S,d as te,B as j,_ as ie,aa as oe,G as ne,e as Q,F as T,f as c,g as l,w as u,l as g,x as N,j as ae,P as se,q as re,o as y,H as z,y as le,n as D,z as M,v as V,t as L,ab as A,D as ce,i as de,A as E,N as F}from"./index-BSBF4jGH.js";import{Q as U,a as H}from"./QItem-D2c8Co2M.js";import{Q as X}from"./QSeparator-BBtHUKtx.js";import{Q as ue}from"./QList-DPQjt_4m.js";import{Q as fe}from"./QMenu-DSB_uF9S.js";import{T as pe}from"./TouchPan-DZJlNQpP.js";import{u as me}from"./use-render-cache-DLxPkVnQ.js";import{Q as he}from"./QPagination-BX1f1nDH.js";import{C as O}from"./ClosePopup-CTuEMMh8.js";import"./position-engine-DU4jhfDu.js";import"./QInput-CCszA-Cu.js";import"./use-key-composition-Z-2-MGMt.js";import"./use-id-BKlrVpl6.js";import"./format-CoaQEihs.js";const G=[["left","center","start","width"],["right","center","end","width"],["top","start","center","height"],["bottom","end","center","height"]],ge=Y({name:"QSlideItem",props:{...J,leftColor:String,rightColor:String,topColor:String,bottomColor:String,onSlide:Function},emits:["action","top","right","bottom","left"],setup(w,{slots:n,emit:k}){const{proxy:C}=K(),{$q:$}=C,q=W(w,$),{getCache:B}=me(),v=R(null);let m=null,a={},_={},x={};const h=P(()=>$.lang.rtl===!0?{left:"right",right:"left"}:{left:"left",right:"right"}),I=P(()=>"q-slide-item q-item-type overflow-hidden"+(q.value===!0?" q-slide-item--dark q-dark":""));function i(){v.value.style.transform="translate(0,0)"}function t(e,s,d){w.onSlide!==void 0&&k("slide",{side:e,ratio:s,isReset:d})}function o(e){const s=v.value;if(e.isFirst)a={dir:null,size:{left:0,right:0,top:0,bottom:0},scale:0},s.classList.add("no-transition"),G.forEach(r=>{if(n[r[0]]!==void 0){const b=x[r[0]];b.style.transform="scale(1)",a.size[r[0]]=b.getBoundingClientRect()[r[3]]}}),a.axis=e.direction==="up"||e.direction==="down"?"Y":"X";else if(e.isFinal){s.classList.remove("no-transition"),a.scale===1?(s.style.transform=`translate${a.axis}(${a.dir*100}%)`,m!==null&&clearTimeout(m),m=setTimeout(()=>{m=null,k(a.showing,{reset:i}),k("action",{side:a.showing,reset:i})},230)):(s.style.transform="translate(0,0)",t(a.showing,0,!0));return}else e.direction=a.axis==="X"?e.offset.x<0?"left":"right":e.offset.y<0?"up":"down";if(n.left===void 0&&e.direction===h.value.right||n.right===void 0&&e.direction===h.value.left||n.top===void 0&&e.direction==="down"||n.bottom===void 0&&e.direction==="up"){s.style.transform="translate(0,0)";return}let d,p,f;a.axis==="X"?(p=e.direction==="left"?-1:1,d=p===1?h.value.left:h.value.right,f=e.distance.x):(p=e.direction==="up"?-2:2,d=p===2?"top":"bottom",f=e.distance.y),!(a.dir!==null&&Math.abs(p)!==Math.abs(a.dir))&&(a.dir!==p&&(["left","right","top","bottom"].forEach(r=>{_[r]&&(_[r].style.visibility=d===r?"visible":"hidden")}),a.showing=d,a.dir=p),a.scale=Math.max(0,Math.min(1,(f-40)/a.size[d])),s.style.transform=`translate${a.axis}(${f*p/Math.abs(p)}px)`,x[d].style.transform=`scale(${a.scale})`,t(d,a.scale,!1))}return Z(()=>{_={},x={}}),ee(()=>{m!==null&&clearTimeout(m)}),Object.assign(C,{reset:i}),()=>{const e=[],s={left:n[h.value.right]!==void 0,right:n[h.value.left]!==void 0,up:n.bottom!==void 0,down:n.top!==void 0},d=Object.keys(s).filter(f=>s[f]===!0);G.forEach(f=>{const r=f[0];n[r]!==void 0&&e.push(S("div",{key:r,ref:b=>{_[r]=b},class:`q-slide-item__${r} absolute-full row no-wrap items-${f[1]} justify-${f[2]}`+(w[r+"Color"]!==void 0?` bg-${w[r+"Color"]}`:"")},[S("div",{ref:b=>{x[r]=b}},n[r]())]))});const p=S("div",{key:`${d.length===0?"only-":""} content`,ref:v,class:"q-slide-item__content"},te(n.default));return d.length===0?e.push(p):e.push(j(p,B("dir#"+d.join(""),()=>{const f={prevent:!0,stop:!0,mouse:!0};return d.forEach(r=>{f[r]=!0}),[[pe,o,void 0,f]]}))),S("div",{class:I.value},e)}}}),ye={class:"h-full overflow-auto md:px-8 md:mx-28 px-3 pb-6"},ve={class:"flex justify-end items-center pt-3"},_e={class:"notification-list"},xe={class:"row items-center",style:{"border-radius":"12px"}},be=["onClick"],we={class:"flex justify-between items-start"},ke={style:{flex:"1"}},Ce={class:"notification-message mt-1"},$e={class:"notification-time mb-0"},qe={class:"notification-action-section"},Se={flat:"",rounded:"",color:"primary",size:"sm",class:"ml-1 md:ml-3 cursor-pointer"},Qe=["innerHTML"],Me={class:"flex justify-end py-4"},Be={key:1,class:"h-full flex flex-center"},Ie={__name:"notificationsPage",setup(w){const n=oe(),k=re(),C=R(!1),$=R(!1),q=async(i=1)=>{C.value=!0;try{await n.fetch({page:i,per_page:15}),await n.fetchUnreadCount()}finally{C.value=!1,$.value=!0}},B=i=>{var o;const t=((o=i==null?void 0:i.data)==null?void 0:o.url)||(i==null?void 0:i.url);t&&k.push(t)},v=async i=>{i.read_at||await n.markAsRead(i.id)},m=async()=>{await n.markAllAsRead()},a=async i=>{try{await n.deleteNotification(i.id),F.create({type:"positive",message:"Notificación eliminada",position:"top",timeout:2e3})}catch{F.create({type:"negative",message:"Error al eliminar notificación",position:"top",timeout:2e3})}},_=i=>{var o,e,s;const t=(((o=i==null?void 0:i.data)==null?void 0:o.title)||"").toLowerCase();return t.includes("admin")?"eva-calendar-outline":t.includes("notice")||t.includes("tablón")?"eva-volume-up-outline":t.includes("maintenance")||t.includes("mantenimiento")?"eva-credit-card-outline":t.includes("service")||t.includes("servicio")?"eva-settings-outline":((s=(e=i==null?void 0:i.data)==null?void 0:e.meta)==null?void 0:s.icon)||"eva-bell-outline"},x=i=>{var o;const t=(((o=i==null?void 0:i.data)==null?void 0:o.title)||"").toLowerCase();return t.includes("admin")?"blue":t.includes("notice")||t.includes("tablón")?"orange":t.includes("maintenance")||t.includes("mantenimiento")?"red":t.includes("service")||t.includes("servicio")?"primary":i.read_at?"grey":"primary"},h=i=>{if(!i)return"";const t=new Date,o=new Date(i),e=Math.floor((t-o)/1e3);if(e<60)return"1 min";if(e<3600)return`${Math.floor(e/60)} min`;if(e<86400)return`${Math.floor(e/3600)} hr`;{const s=Math.floor(e/86400);return`${s} día${s>1?"s":""}`}},I=i=>{var t,o,e;return window.screen.width>780?`${((t=i.data)==null?void 0:t.message)||""}`:`${(o=i.data)!=null&&o.message?(e=i.data)==null?void 0:e.message.substr(0,30):""}...`};return ne(()=>{q()}),(i,t)=>(y(),Q("div",ye,[$.value?(y(),Q(T,{key:0},[c("div",ve,[l(N,{color:"primary",style:{"border-radius":"0.4rem"},"no-caps":"",onClick:m,disable:g(n).unreadCount===0},{default:u(()=>[...t[2]||(t[2]=[c("div",{class:"px-2"}," Marcar todas como leídas ",-1)])]),_:1},8,["disable"])]),c("div",_e,[(y(!0),Q(T,null,ae(g(n).items,o=>(y(),z(ge,{key:o.id,onRight:()=>a(o),"right-color":"red-8",class:"my-3 notification-container",style:{"border-radius":"12px!important"}},{right:u(()=>[c("div",xe,[l(V,{name:"eva-trash-2-outline"}),t[3]||(t[3]=c("div",{class:"ml-1 text-subtitle2"}," Borrar notificación ",-1))])]),default:u(()=>[l(le,{class:D(["notification-card q-mb-4 py-2 px-1",{"notification-read":o.read_at}]),flat:"",bordered:""},{default:u(()=>[l(M,{class:"q-py-none q-px-sm justify-between",horizontal:""},{default:u(()=>[c("section",{class:"flex firstPart",onClick:e=>B(o)},[l(M,{class:"notification-icon-section q-pa-0 q-px-none q-py-none flex flex-center"},{default:u(()=>[c("div",{class:D([`bg-${x(o)}`,"iconNotificationList p-3"])},[l(V,{name:_(o),color:"white",size:"25px"},null,8,["name"])],2)]),_:2},1024),l(M,{class:"notification-content-section q-pa-0 q-px-none q-py-none q-pl-sm",style:{flex:"1"}},{default:u(()=>{var e;return[c("div",we,[c("div",ke,[c("div",{class:D(["notification-title font-medium",{"text-weight-bold":!o.read_at}])},L(((e=o.data)==null?void 0:e.title)||"Notificación"),3),c("div",Ce,L(I(o)),1)])])]}),_:2},1024)],8,be),l(M,{class:"flex column items-end q-pa-0 q-px-none q-py-none"},{default:u(()=>[c("div",$e,L(h(o.created_at))+"(s) ",1),c("div",qe,[l(N,{flat:"",round:"",dense:"",size:"1.1rem",icon:"eva-checkmark-circle-2-outline",color:o.read_at?"grey":"primary",onClick:A(e=>v(o),["stop"]),disable:!!o.read_at},null,8,["color","onClick","disable"]),c("div",Se,[c("div",{innerHTML:g(ce).optionsBook},null,8,Qe),l(fe,null,{default:u(()=>[l(ue,{style:{"min-width":"150px"}},{default:u(()=>[o.read_at?de("",!0):j((y(),z(U,{key:0,clickable:"",onClick:A(e=>v(o),["stop"])},{default:u(()=>[l(H,null,{default:u(()=>[...t[4]||(t[4]=[E("Marcar como leida",-1)])]),_:1})]),_:1},8,["onClick"])),[[O]]),l(X),j((y(),z(U,{clickable:"",onClick:e=>a(o)},{default:u(()=>[l(H,null,{default:u(()=>[...t[5]||(t[5]=[E("Borrar",-1)])]),_:1})]),_:1},8,["onClick"])),[[O]]),l(X)]),_:2},1024)]),_:2},1024)])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"])]),_:2},1032,["onRight"]))),128))]),c("div",Me,[l(he,{modelValue:g(n).pagination.current_page,"onUpdate:modelValue":[t[0]||(t[0]=o=>g(n).pagination.current_page=o),t[1]||(t[1]=o=>q(o))],max:Math.ceil(g(n).pagination.total/g(n).pagination.per_page)||1,color:"primary"},null,8,["modelValue","max"])])],64)):(y(),Q("div",Be,[l(se,{color:"primary",size:"4rem",thickness:5})]))]))}},Xe=ie(Ie,[["__scopeId","data-v-855a4b67"]]);export{Xe as default};
